<!--Borrow from Nerfies https://github.com/nerfies/nerfies.github.io/tree/main-->
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Enhancing Faithfulness in Reference-based Inpainting with Correspondence Guidance in Diffusion Models.">
  <meta name="keywords" content="Diffusion Models, Generative Models, Image Inpainting, Reference-based Inpainting, Training-free">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CorrFill: Enhancing Faithfulness in Reference-based Inpainting with Correspondence Guidance in Diffusion Models</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <!--link rel="icon" href="./static/images/favicon.svg"-->

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <!--div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://github.com/khliu0000">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>

    </div>

  </div-->
</nav>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">CorrFill: Enhancing Faithfulness in Reference-based Inpainting with Correspondence Guidance in Diffusion Models</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://github.com/khliu0000">Kuan-Hung Liu</a><sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="https://scholar.google.com.hk/citations?user=Ke4_ozgAAAAJ">Cheng-Kun Yang</a><sup>2</sup>,
            </span>
            <span class="author-block">
              <a href="https://minhungchen.netlify.app/">Min-Hung Chen</a><sup>3</sup>,
            </span>
            <span class="author-block">
              <a href="https://yulunalexliu.github.io/">Yu-Lun Liu</a><sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="https://sites.google.com/site/yylinweb/">Yen-Yu Lin</a><sup>1</sup>,
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>National Yang Ming Chiao Tung University,</span>
            <span class="author-block"><sup>2</sup>National Taiwan University</span>
            <span class="author-block"><sup>3</sup>NVIDIA</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/pdf/2501.02355"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://arxiv.org/abs/2501.02355"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code (Coming Soon)</span>
                  </a>
              </span>
              <h2 class="subtitle is-size-4 has-text-centered"> WACV 2025 </h2>
            </div>

          </div>
          
        </div>
      </div>
    </div>
  </div>
</section>
<!--
<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <video id="teaser" autoplay muted loop playsinline height="100%">
        <source src="./static/videos/teaser.mp4"
                type="video/mp4">
      </video>
      <h2 class="subtitle has-text-centered">
        <span class="dnerf">Nerfies</span> turns selfie videos from your phone into
        free-viewpoint
        portraits.
      </h2>
    </div>
  </div>
</section>


<section class="hero is-light is-small">
  <div class="hero-body">
    <div class="container">
      <div id="results-carousel" class="carousel results-carousel">
        <div class="item item-steve">
          <video poster="" id="steve" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/steve.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-chair-tp">
          <video poster="" id="chair-tp" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/chair-tp.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-shiba">
          <video poster="" id="shiba" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/shiba.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-fullbody">
          <video poster="" id="fullbody" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/fullbody.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-blueshirt">
          <video poster="" id="blueshirt" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/blueshirt.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-mask">
          <video poster="" id="mask" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/mask.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-coffee">
          <video poster="" id="coffee" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/coffee.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-toby">
          <video poster="" id="toby" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/toby2.mp4"
                    type="video/mp4">
          </video>
        </div>
      </div>
    </div>
  </div>
</section>-->

<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <img src="static/images/teaser.png" alt="teaser" width="500" height="300">
    </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">

        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            In the task of reference-based image inpainting, an additional reference 
            image is provided to restore a damaged target image to its original state. 
            The advancement of diffusion models, particularly Stable Diffusion, allows 
            for simple formulations in this task. However, existing diffusion-based methods 
            often lack explicit constraints on the correlation between the reference and 
            damaged images, resulting in lower faithfulness to the reference images in the 
            inpainting results. 
          </p>
          <p>
            In this work, we propose CorrFill, a training-free module 
            designed to enhance the awareness of geometric correlations between the reference 
            and target images. This enhancement is achieved by guiding the inpainting process 
            with correspondence constraints estimated during inpainting, utilizing attention 
            masking in self-attention layers and an objective function to update the input tensor 
            according to the constraints. 
          </p>
          <p>
            Experimental results demonstrate that CorrFill 
            significantly enhances the performance of multiple baseline diffusion-based methods, 
            including state-of-the-art approaches, by emphasizing faithfulness to the 
            reference images.
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->

  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Pipeline</h2>
        <div class="hero-body">
          <img src="static/images/overview.png" alt="pipeline"  height="300">
        </div>
        <div class="content has-text-justified">
          <p>
            <b>CorrFill Inpainting Pipeline.</b>
            The inpainting process of Stable Diffusion involves iterations of progressive
            denoising. During each denoising step, CorrFill estimates the
            correspondence between the target and reference images and guides the subsequent
            denoising step accordingly. This approach ensures that the denoising process and
            correspondence estimation converge towards a pattern that remains faithful to the
            reference image.
          </p>
        </div>

      </div>
    </div>


    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Results</h2>
        <div class="hero-body">
          <img src="static/images/result.png" alt="result">
        </div>
        <div class="content has-text-justified">
          <p>
            <b>Results Comparisons.</b>
            The comparisons between four baselines and their CorrFill-enhanced counterparts on
            two datasets. Problematic regions in the results of the baseline methods effectively
            addressed by CorrFill are highlighted in red boxes.
          </p>
        </div>
      </div>
    </div>

  </div>
</section>

<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@inproceedings{liu2025corrfill,
      title={CorrFill: Enhancing Faithfulness in Reference-based Inpainting with Correspondence Guidance in Diffusion Models},
      author={Liu, Kuan-Hung and Yang, Cheng-Kun and Chen, Min-Hung and Liu, Yu-Lun and Lin, Yen-Yu},
      booktitle={WACV},
      year={2025}
    }</code></pre>
  </div>
</section>

<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link"
         href="./static/paper/corrfill_paper.pdf">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://github.com/khliu0000" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
      <p>
        Special thanks to <a
        href="https://github.com/nerfies/nerfies.github.io">Nerfies</a> for providing the codebase for this website.
      </p>
    </div>
  </div>
</footer>

</body>
</html>
